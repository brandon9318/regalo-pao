<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Pao üíï</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        /* =========================================
           1. ESTILOS VISUALES
           ========================================= */
        :root {
            --primary: #ff69b4;
            --secondary: #5c3a93;
            --accent: #ff4757;
            --white: #ffffff;
            --glass: rgba(255, 255, 255, 0.25);
            --border: rgba(255, 255, 255, 0.4);
            --shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Estrellas */
        .star-field { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0; animation: twinkle var(--dur) ease-in-out infinite; animation-delay: var(--del); }
        @keyframes twinkle { 0% { opacity: 0; transform: scale(0); } 50% { opacity: 0.8; transform: scale(1); } 100% { opacity: 0; transform: scale(0); } }

        /* Tarjeta */
        .container {
            position: relative; z-index: 10; padding: 2.5rem; width: 90%; max-width: 600px;
            background: var(--glass); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
            border-radius: 30px; border: 1px solid var(--border); box-shadow: var(--shadow);
            text-align: center; animation: popIn 1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { opacity: 0; transform: scale(0.8) translateY(20px); } to { opacity: 1; transform: scale(1) translateY(0); } }

        h1 { font-family: 'Pacifico', cursive; font-size: clamp(2.5rem, 6vw, 4rem); color: var(--white); text-shadow: 2px 2px 4px rgba(0,0,0,0.2); margin-bottom: 15px; line-height: 1.2; }
        .subtitle { font-size: clamp(1.1rem, 3.5vw, 1.4rem); color: var(--white); margin-bottom: 25px; font-weight: 600; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        .details { font-size: clamp(0.9rem, 2.5vw, 1.1rem); color: var(--secondary); background: rgba(255,255,255,0.5); padding: 8px 20px; border-radius: 50px; display: inline-block; margin-bottom: 30px; font-weight: 700; }

        /* Botones */
        .controls { display: flex; flex-direction: column; gap: 15px; align-items: center; margin-bottom: 30px; }
        .btn {
            border: none; padding: 14px 35px; font-size: 1.1rem; font-family: 'Quicksand', sans-serif; font-weight: 700;
            border-radius: 50px; cursor: pointer; box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4);
            transition: 0.3s; display: flex; align-items: center; gap: 10px; width: 80%; max-width: 300px; justify-content: center;
            position: relative; overflow: hidden;
        }
        .btn::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); transition: 0.5s; }
        .btn:hover::after { left: 100%; }
        .btn:active { transform: scale(0.95); }
        .btn-music { background: var(--primary); color: white; }
        .btn-music.playing { background: var(--accent); animation: pulse 2s infinite; }
        .btn-letter { background: white; color: var(--secondary); }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.7); } 70% { box-shadow: 0 0 0 20px rgba(255, 71, 87, 0); } }

        /* Ositos */
        .bears { display: flex; justify-content: center; gap: 20px; }
        .bear-icon { font-size: clamp(3rem, 10vw, 4.5rem); cursor: pointer; transition: 0.4s; filter: drop-shadow(0 8px 8px rgba(0,0,0,0.15)); user-select: none; }
        .bear-icon:hover { transform: scale(1.2) rotate(10deg) translateY(-10px); }

        /* Efectos */
        .falling-item { position: absolute; top: -50px; font-size: 2rem; animation: fall linear forwards; cursor: pointer; z-index: 5; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
        .burst { position: absolute; pointer-events: none; animation: fly 1s ease-out forwards; font-size: 1.5rem; z-index: 20; }
        @keyframes fly { to { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(1.5) rotate(var(--r)); } }
        .float-text { position: absolute; font-size: 1.5rem; color: white; font-weight: 800; text-shadow: 0 2px 4px rgba(0,0,0,0.5); pointer-events: none; z-index: 25; animation: floatUp 2s ease-out forwards; }
        @keyframes floatUp { to { opacity: 0; transform: translateY(-100px); } }

        /* Modal Carta */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 100; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: 0.4s; padding: 20px; }
        .modal.active { opacity: 1; pointer-events: all; }
        .modal-box { background: white; padding: 30px; border-radius: 20px; max-width: 500px; width: 100%; transform: translateY(50px); transition: 0.4s; max-height: 80vh; overflow-y: auto; }
        .modal.active .modal-box { transform: translateY(0); }
        .modal-title { font-family: 'Pacifico', cursive; font-size: 2rem; color: var(--primary); text-align: center; margin-bottom: 20px; border-bottom: 2px dashed #eee; }
        .modal-text { font-size: 1.1rem; color: #444; line-height: 1.8; margin-bottom: 25px; white-space: pre-line; }
        .btn-close { display: block; margin: 0 auto; background: var(--secondary); color: white; border: none; padding: 10px 25px; border-radius: 30px; font-weight: bold; cursor: pointer; }

        /* =========================================
           7. REPRODUCTOR VISIBLE PERO TRANSPARENTE
           ========================================= */
        /* Esto es clave: El video est√° en la esquina, ocupando espacio,
           pero es invisible. As√≠ el navegador NO lo bloquea. */
        #player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 1px;
            height: 1px;
            opacity: 0.01; /* Casi invisible, pero el navegador lo ve */
            pointer-events: none;
            z-index: 9999;
        }
    </style>
</head>
<body>
    <div class="star-field" id="stars"></div>

    <div class="container">
        <h1>¬°Te quiero mucho, Pao! üíñ</h1>
        <div class="subtitle">¬°Eres muy especial! ‚ú®</div>
        <div class="details">De Brandon para Pao üéÑ Feliz Navidad</div>

        <div class="controls">
            <button class="btn btn-music" id="musicBtn" onclick="toggleMusic()">
                <span>üéµ</span> <span id="btnText">Dedicar canci√≥n</span>
            </button>
            
            <button class="btn btn-letter" onclick="toggleLetter(true)">
                <span>üíå</span> <span>Leer cartita</span>
            </button>
        </div>

        <div class="bears">
            <span class="bear-icon" onclick="burst(event)">üß∏</span>
            <span class="bear-icon" onclick="burst(event)">‚ù§Ô∏è</span>
            <span class="bear-icon" onclick="burst(event)">üß∏</span>
        </div>
    </div>

    <div class="modal" id="letterModal" onclick="if(event.target===this) toggleLetter(false)">
        <div class="modal-box">
            <div class="modal-title">Para Pao üíï</div>
            <div class="modal-text">
                ¬°Hola Pao! 
                
                Quer√≠a darte este peque√±o detalle para recordarte lo especial que eres.
                
                Espero que pases una Navidad incre√≠ble. Me encanta compartir momentos contigo.
                
                ¬°Te quiero mucho! ‚ú®
                
                Atte: Brandon üß∏
            </div>
            <button class="btn-close" onclick="toggleLetter(false)">Cerrar</button>
        </div>
    </div>

    <div id="player"></div>

    <script>
        // 1. ESTRELLAS
        const starsObj = document.getElementById('stars');
        for(let i=0; i<50; i++) {
            const s = document.createElement('div');
            s.className = 'star';
            s.style.left = Math.random()*100 + '%';
            s.style.top = Math.random()*100 + '%';
            s.style.width = s.style.height = (Math.random()*3+1) + 'px';
            s.style.setProperty('--dur', (Math.random()*3+2)+'s');
            s.style.setProperty('--del', (Math.random()*5)+'s');
            starsObj.appendChild(s);
        }

        // 2. CONFIGURACI√ìN DE YOUTUBE (Robustez M√°xima)
        var player, isPlaying = false;
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.body.appendChild(tag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '200', // Tama√±o "real" para enga√±ar al navegador
                width: '200',
                // El video que me pasaste: Juan Gabriel - Me Gustas Mucho
                videoId: 'h7q_qMNciHs', 
                playerVars: { 
                    'playsinline': 1, // Importante para iPhone
                    'controls': 0, 
                    'loop': 1, 
                    'playlist': 'h7q_qMNciHs', 
                    'origin': window.location.origin
                },
                events: { 
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError
                }
            });
        }

        function onPlayerReady(event) {
            console.log("Reproductor listo.");
            // Intentar subir volumen al m√°ximo
            event.target.setVolume(100);
        }

        function onPlayerStateChange(event) {
            // Si el video termina o se pausa por error, intentar reproducir si deber√≠a estar sonando
            if (event.data === YT.PlayerState.ENDED && isPlaying) {
                player.playVideo();
            }
        }

        function onPlayerError(event) {
            console.error("Error de YouTube:", event.data);
            alert("‚ö†Ô∏è Hubo un problema cargando la canci√≥n (Error " + event.data + "). Intenta recargar la p√°gina.");
        }

        function toggleMusic() {
            const btn = document.getElementById('musicBtn');
            const txt = document.getElementById('btnText');
            
            if(!player) {
                // Si el usuario da clic muy r√°pido antes de que cargue YouTube
                alert("Cargando la m√∫sica... espera un segundo y vuelve a dar clic.");
                return;
            }

            if(isPlaying) {
                player.pauseVideo();
                btn.classList.remove('playing');
                txt.textContent = "Reproducir canci√≥n";
                isPlaying = false;
            } else {
                // AQU√ç OCURRE LA MAGIA DEL AUDIO
                player.playVideo();
                // Asegurar volumen otra vez al dar click
                player.setVolume(100);
                
                btn.classList.add('playing');
                txt.textContent = "Sonando: Me gustas mucho...";
                isPlaying = true;
                
                // Efecto visual
                for(let i=0; i<3; i++) setTimeout(() => 
                    createBurst(window.innerWidth/2, window.innerHeight/2), i*300);
            }
        }

        // 3. INTERFAZ
        function toggleLetter(show) {
            const m = document.getElementById('letterModal');
            show ? m.classList.add('active') : m.classList.remove('active');
        }

        function burst(e) {
            createBurst(e.clientX, e.clientY);
            createFloatText(e.clientX, e.clientY);
        }

        function createBurst(x, y) {
            const symbols = ['‚ù§Ô∏è', 'üíï', '‚ú®', 'üå∏', 'üíñ'];
            for(let i=0; i<12; i++) {
                const p = document.createElement('div');
                p.className = 'burst';
                p.textContent = symbols[Math.floor(Math.random()*symbols.length)];
                p.style.left = x + 'px'; p.style.top = y + 'px';
                
                const angle = Math.random() * Math.PI * 2;
                const dist = Math.random() * 100 + 50;
                p.style.setProperty('--tx', Math.cos(angle)*dist + 'px');
                p.style.setProperty('--ty', Math.sin(angle)*dist + 'px');
                p.style.setProperty('--r', Math.random()*360 + 'deg');
                
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 1000);
            }
        }

        function createFloatText(x, y) {
            const texts = ['¬°Te Quiero!', '¬°Linda!', 'üíï', '¬°Me Gustas!'];
            const t = document.createElement('div');
            t.className = 'float-text';
            t.textContent = texts[Math.floor(Math.random()*texts.length)];
            t.style.left = (x + (Math.random()-0.5)*40) + 'px';
            t.style.top = y + 'px';
            document.body.appendChild(t);
            setTimeout(() => t.remove(), 2000);
        }

        // 4. LLUVIA
        setInterval(() => {
            const el = document.createElement('div');
            el.className = 'falling-item';
            el.textContent = Math.random()>0.5 ? 'üß∏' : 'üíñ';
            el.style.left = Math.random()*90+5 + '%';
            el.style.animationDuration = (Math.random()*5+4) + 's';
            document.body.appendChild(el);
            
            el.onclick = (e) => {
                e.stopPropagation();
                burst(e);
                el.remove();
            };
            setTimeout(() => { if(el.parentNode) el.remove(); }, 9000);
        }, window.innerWidth<768 ? 800 : 400);

    </script>
</body>
</html>
